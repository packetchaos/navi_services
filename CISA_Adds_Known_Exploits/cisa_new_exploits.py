from os import system as cmd
import os
import time

start = time.time()

access_key = os.environ['access_key'] # str(sys.argv[1])
secret_key = os.environ['secret_key'] # str(sys.argv[2])

url = "https://cloud.tenable.com"

# Replace 'access_key and secret_key with your keys
cmd('navi keys --a "{}" --s "{}"'.format(access_key, secret_key))

# Update the navi database for tagging on vulns
cmd('navi update full')

# April 7th release - https://www.cisa.gov/news-events/alerts/2023/04/07/cisa-adds-five-known-exploited-vulnerabilities-catalog
cve_list = ['CVE-2021-27876', 'CVE-2021-27877', 'CVE-2021-27878', 'CVE-2019-1388', 'CVE-2023-26083']


def grab_headers():
    return {'Content-type': 'application/json', 'user-agent': 'Navi-SS-Scan_tags', 'X-ApiKeys': 'accessKey=' + access_key + ';secretKey=' + secret_key}


# Tag assets by New CVEs released by CISA
for cve in cve_list:
    cmd('navi tag --c "CISA Known Exploits" --v "Released April 7th {}" --cve "{}"'.format(cve, cve))


finish = time.time()

total = finish - start
mins = total/60

print("The Script took {} seconds or {} minutes".format(total, mins))


