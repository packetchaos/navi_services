<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Navi WAS Reporting</title>
    <style>
body {
font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
text-align: left;
background-color: #f7f7f7;
}
h1 {
font-size: 1.6em;
}
h2 {
font-size: 1.4em;
}
pre {
font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  overflow-x: auto;
  white-space: pre-wrap;
#  white-space: -moz-pre-wrap;
#  white-space: -pre-wrap;
#  white-space: -o-pre-wrap;
  word-wrap: break-word;
}
td {
font-size: 0.9em;
}
.table1 tr:nth-child(even) {
background-color: #f7f7f7;
}
.table1 tr:nth-child(odd) {
background-color: white;
}
.breakdown td{
border-bottom: 1px solid #ddd;
border-right: 1px solid #ddd;
}
.td_orange{
font-size: 0.9em;
background-color: #FF9757;
}
.td_green{
font-size: 0.9em;
background-color: #78AF43;
}
.td_red{
font-size: 0.9em;
background-color: #F6303E;
}
.page_heading {
padding-left: 15px;
}
.bar_chart_fl b {
font-size: 1.2em;
}
.bar_chart_fl {
font-size: 0.8em;
float: left;
background-color: white;
padding: 10px;
margin: 10px;
text-align: left;
border: 2px solid white;
border-radius: 3px;
#box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
}
.bar_chart_fl_2 {
font-size: 0.8em;
background-color: white;
padding: 10px;
margin: 10px;
text-align: left;
border: 2px solid white;
border-radius: 3px;
#box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
}
.hideme {
display: none;
}
.critical {
background-color: #91243E;
color: white;
text-align: center;
border: 2px solid #708090;
border-radius: 3px;
padding: 2px;
}
.high {
background-color: #DD4B50;
color: white;
text-align: center;
border: 2px solid #708090;
border-radius: 3px;
padding: 2px;
}
.medium {
background-color: #F18C43;
color: white;
text-align: center;
border: 2px solid #708090;
border-radius: 3px;
padding: 2px;
}
.low {
background-color: #F8C851;
color: white;
text-align: center;
border: 2px solid #708090;
border-radius: 3px;
padding: 2px;
}
.info {
background-color: #67ACE1;
color: white;
text-align: center;
border: 2px solid #708090;
border-radius: 3px;
padding: 2px;
}
pre {
overflow-x: auto;
white-space: pre-wrap;
word-wrap: break-word;
}
.floatleft {
float: left;
}
.floatright {
float: right;
}
.border1 {
border: 2px solid #4b4b4b;
border-radius: 5px;
background-color: white;
padding: 10px;
margin-bottom: 10px;
margin-top: 10px;
}
.plugout {
border: 2px solid black;
border-radius: 5px;
width: 70%;
background-color: #0d3d5c;
color: white;
padding-top: 10px;
padding-bottom: 10px;
padding-left: 10px;
padding-right: 10px;
}
.article_no_page {
padding-left: 30px;
padding-right: 30px;
margin-bottom: 20px;
background-color: #ececec;
border: 2px solid #4b4b4b;
color: black;
border-radius: 3px;
box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
}
}
</style>
</head>
<body>
<div class=page_heading>
    <table width=100%>
        <h1>WAS Report for {{target}}</h1>
    </table>
</div>

<!-- Vulnerability Breakdown -->
<div class=bar_chart_fl>
    <table width=100%>
        <tr>
            <td align=center><h2>Vulnerability Breakdown</h2></td>
    </table>
    <table class=table1 width=100%>
        <tr>
            <td width=80%>Critical Vulnerabilities</td>
            <td class=critical width=20% align=center>{{critical}}</td>
        </tr>

        <tr>
        <td width=80%x>High Vulnerabilities</td>
        <td class=high width=20% align=center>{{high}}</td>
        </tr>

        <tr>
        <td width=80%>Medium Vulnerabilities</td>
        <td class=medium width=20% align=center>{{medium}}</td>
        </tr>

        <tr>
        <td width=80%>Low Vulnerabilities</td>
        <td class=low width=20% align=center>{{low}}</td>
        </tr>

        <tr>
        <td width=80%>Informational Items</td>
        <td class=info width=20% align=center>{{info}}</td>
        </tr>
    </table>
</div>

<!-- Scan Job Information -->
<div class=bar_chart_fl>
    <table width=100%>
        <tr>
            <td><h2>Scan Job Information</h2></td>
    </table>

    <table class=table1 width=100%>
        <tr>
            <td>Scan Name</td>
            <td>{{name}}</td>
        </tr>

        <tr>
            <td>Target</td>
            <td>{{target}}</td>
        </tr>
        <tr>
            <td>Date</td>
            <td>{{scan_completed_time}}</td>
        </tr>
        <tr>
            <td>Scann UUID</td>
            <td><a href="https://cloud.tenable.com/tio/app.html#/webapp-scanning/scans/folders/2/scan-details/{{scan_uuid}}/vulnerabilities" target="_blank">{{scan_uuid}}</a></td>
        </tr>
        <tr>
            <td>Asset UUID</td>
            <td><a href="https://cloud.tenable.com/tio/app.html#/webapp-scanning/dashboard/vulnerabilities/applications/application-details/{{asset_uuid}}" target="_blank">{{asset_uuid}}</a></td>
        </tr>

    </table>
</div>

<div></div>
<!-- Technologies Found -->
<div class=bar_chart_fl>
    <table width=100%>
        <tr>
            <td><h2>Technologies Found</h2></td>
    </table>

    <table class=table1 width=100%>

        {%for item in tech_list%}
        <tr>
            <td>{{item}}</td>
        </tr>
            {% endfor %}
    </table>
</div>


<!-- Site Map -->
<div class=bar_chart_fl_2>
    <table width=100%>
        <tr>
            <td><h1>Site Map Information</h1></td>
    </table>

    <table class=table1 width=100%>
        <tr>
            <th><pre>{{sitemap}}</pre></th>

        </tr>

    </table>
</div>

<!-- Scan Stats -->
<div class=page_heading>
    <h1>Scan Statistics</h1>
</div>
<div class=bar_chart_fl_2>

    <table class=table1 width=100%>
        <tr>
            <th><pre>{{scan_stats}}</pre></th>

        </tr>

    </table>
</div>

<div class=page_heading></div>

<!-- Vulnerability Summary -->
<div class=page_heading>
<h1>Vulnerability Summary</h1>
</div>

<!-- Critical -->
<div class=bar_chart_fl>
    <table class=table1 width=100%>
         <tr>
            <th width=10%>Severity</th>
            <th width=15% align=center>Plugin ID</th>
            <th width=40% align=center>Plugin Name</th>
            <th width=25% align=center>Family</th>
             <th width=10% align=center>OWASP 2021</th>
            <th align=center>Vuln Count</th>
        </tr>
        {%for item in critical_summary%}
        <tr>
            <td class=critical width=10%>{{item[0]}}</td>
            <td width=15% align=center><a href="#{{item[1]}}">{{item[1]}}</a></td>
            <td width=40% align=center>{{item[2]}}</td>
            <td width=25% align=center>{{item[3]}}</td>
            <td align=center>{{item[4]}}</td>
            <td align=center>{{item[5]}}</td>
        </tr>
        {% endfor %}
    </table>
</div>

<!-- High -->
<div class=bar_chart_fl>
    <table class=table1 width=100%>
         <tr>
            <th width=10%>Severity</th>
            <th width=15% align=center>Plugin ID</th>
            <th width=40% align=center>Plugin Name</th>
            <th width=25% align=center>Family</th>
             <th width=10% align=center>OWASP 2021</th>
            <th align=center>Vuln Count</th>
        </tr>
        {%for item in high_summary%}
       <tr>
            <td class=high width=10%>{{item[0]}}</td>
            <td width=15% align=center><a href="#{{item[1]}}">{{item[1]}}</a></td>
            <td width=40% align=center>{{item[2]}}</td>
            <td width=25% align=center>{{item[3]}}</td>
            <td align=center>{{item[4]}}</td>
           <td align=center>{{item[5]}}</td>
        </tr>
        {% endfor %}
    </table>

</div>

<!-- Medium-->
<div class=bar_chart_fl>
    <table class=table1 width=100%>
     <tr>
            <th width=10%>Severity</th>
            <th width=15% align=center>Plugin ID</th>
            <th width=40% align=center>Plugin Name</th>
            <th width=25% align=center>Family</th>
         <th width=10% align=center>OWASP 2021</th>
            <th align=center>Vuln Count</th>
        </tr>
        {%for item in medium_summary%}
       <tr>
            <td class=medium width=10%>{{item[0]}}</td>
            <td width=15% align=center><a href="#{{item[1]}}">{{item[1]}}</a></td>
            <td width=40% align=center>{{item[2]}}</td>
            <td width=25% align=center>{{item[3]}}</td>
            <td align=center>{{item[4]}}</td>
           <td align=center>{{item[5]}}</td>
        </tr>
        {% endfor %}
    </table>
</div>

<!-- Low-->
<div class=bar_chart_fl>
    <table class=table1 width=100%>
         <tr>
            <th width=10%>Severity</th>
            <th width=15% align=center>Plugin ID</th>
            <th width=40% align=center>Plugin Name</th>
            <th width=25% align=center>Family</th>
             <th width=10% align=center>OWASP 2021</th>
            <th align=center>Vuln Count</th>
        </tr>
        {%for item in low_summary%}
       <tr>
            <td class=low width=10%>{{item[0]}}</td>
            <td width=15% align=center><a href="#{{item[1]}}">{{item[1]}}</a></td>
            <td width=40% align=center>{{item[2]}}</td>
            <td width=25% align=center>{{item[3]}}</td>
            <td align=center>{{item[4]}}</td>
           <td align=center>{{item[5]}}</td>
        </tr>
        {% endfor %}
    </table>
</div>

<!-- Info -->
<div class=bar_chart_fl>
    <table class=table1 width=100%>
         <tr>
            <th width=10%>Severity</th>
            <th width=15% align=center>Plugin ID</th>
            <th width=45% align=center>Plugin Name</th>
            <th width=25% align=center>Family</th>
            <th align=center>Vuln Count</th>
        </tr>
        {%for item in info_summary%}
       <tr>
            <td class=info width=10%>{{item[0]}}</td>
            <td width=15% align=center><a href="#{{item[1]}}">{{item[1]}}</a></td>
            <td width=45% align=center>{{item[2]}}</td>
            <td width=25% align=center>{{item[3]}}</td>
           <td align=center>{{item[5]}}</td>
        </tr>
        {% endfor %}
    </table>
</div>

<!-- Plugin Details-->
{% for k, v in plugin_info_list.items() %}
    <div class=bar_chart_fl id="{{k}}">

        <table width=900px>
            <tr>
                <td align=left width=80px><b>Plugin ID</b></td>
                <td width=80px align=center><b><a href='https://cloud.tenable.com/tio/app.html#/webapp-scanning/dashboard/vulnerabilities/plugins/plugin-details/{{k}}/overview' target="_blank">{{k}}</a></b></td>
                <td width=100px align=center class={{v[0]}}>{{v[0]}}</td><td width=20px>&nbsp;</td>
                <td>{{v[1]}}</td>
            </tr>
        </table>
        <table width=900px>
            <tr>
                <td>&nbsp;</td>
            </tr>
            <tr>

                <td><b>Instances</b></td>

            </tr>

        </table>
        <table width=900px>
            {% for uri in v[5]%}
            <tr>
                <td><a href='{{uri}}'>{{uri}}</a></td>
            </tr>
            {% endfor %}
        </table>
            <table width=900px>
                <tr>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td><b>Description</b></td>
                </tr>
                <tr>
                    <td>{{v[2]}}</td>
                </tr>
                <tr>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td><b>Solution</b></td>
                </tr>
                <tr>
                    <td> {{v[4]}}</td>
                </tr>
                <tr>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td><b>See Also</b></td>
                </tr>
                {% for url in v[3]%}
                <tr>
                    <td><a href='{{url}}'>{{url}}</a></td>
                </tr>
                {% endfor %}
        </table>
    </div>
{% endfor %}
</body>
</html>
